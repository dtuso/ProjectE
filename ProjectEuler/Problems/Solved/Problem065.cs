using System;
using System.Collections.Generic;
using System.Text;
using ProjectEuler.Helpers;


namespace ProjectEuler.Problems
{
	class p065
	{
		// What is most surprising is that the important mathematical constant,
		// e = [2; 1,2,1, 1,4,1, 1,6,1 , ... , 1,2k,1, ...].

		// The first ten terms in the sequence of convergents for e are:
		// 2, 3, 8/3, 11/4, 19/7, 87/32, 106/39, 193/71, 1264/465, 1457/536, ...

		// The sum of digits in the numerator of the 10th convergent is 1+4+5+7=17.

		// Find the sum of digits in the numerator of the 100th convergent of the 
		// continued fraction for e.


		//http://en.wikipedia.org/wiki/Continued_fraction


		public static void Solve(int idxToSolveFor)
		{
			int[] numer = new int[101];
			int[] denom = new int[101];
			int[] writt = new int[101];
			writt[1] = 2;
			numer[1] = 2;
			denom[1] = 1;
			for(int i=0; i<33;i++)
			{
				writt[2 + (i*3)] = 1;
				writt[3 + (i*3)] = (i + 1)*2;
				writt[4 + (i*3)] = 1;
			}
			BigInteger n = 0;
			BigInteger d = 0;
			for (int idx = 1; idx <= idxToSolveFor; idx++)
			{
				BigInteger num1, num2, num3, den1, den2, den3;
				num1 = 1;
				den1 = writt[idx];

				// start at the end and work up the chain
				for (int j = idx - 1; j >= 1; j--)
				{
					num2 = writt[j];

					// get fractions ready to add together
					num2 = (num2 * den1);

					// add together
					num3 = (num1 + num2);
					den3 = den1;

					while(true)
					{
						BigInteger gcd = num3.gcd(den3);
						if(gcd==1)
							break;
						num3 /= gcd;
						den3 /= gcd;
						//MyMath.ReduceFraction(ref num3, ref den3);
					}

					// assign as the new 1, and flip since it's a 1/(x/y)
					num1 = den3;
					den1 = num3;
				}

				n = den1;
				d = num1;
				Console.WriteLine("{0,3}: {1} / {2}", idx, n, d);
			}

			int sum = 0;

			foreach(char c in n.ToString().ToCharArray())
			{
				sum += (Convert.ToInt32(c.ToString()));
			}
			Console.WriteLine("sum = {0}", sum);
		}
	}
}

/*

 Start of Main 10/31/2008 10:27:15 AM
  1: 2 / 1
  2: 3 / 1
  3: 8 / 3
  4: 11 / 4
  5: 19 / 7
  6: 87 / 32
  7: 106 / 39
  8: 193 / 71
  9: 1264 / 465
 10: 1457 / 536
 11: 2721 / 1001
 12: 23225 / 8544
 13: 25946 / 9545
 14: 49171 / 18089
 15: 517656 / 190435
 16: 566827 / 208524
 17: 1084483 / 398959
 18: 13580623 / 4996032
 19: 14665106 / 5394991
 20: 28245729 / 10391023
 21: 410105312 / 150869313
 22: 438351041 / 161260336
 23: 848456353 / 312129649
 24: 14013652689 / 5155334720
 25: 14862109042 / 5467464369
 26: 28875761731 / 10622799089
 27: 534625820200 / 196677847971
 28: 563501581931 / 207300647060
 29: 1098127402131 / 403978495031
 30: 22526049624551 / 8286870547680
 31: 23624177026682 / 8690849042711
 32: 46150226651233 / 16977719590391
 33: 1038929163353808 / 382200680031313
 34: 1085079390005041 / 399178399621704
 35: 2124008553358849 / 781379079653017
 36: 52061284670617417 / 19152276311294112
 37: 54185293223976266 / 19933655390947129
 38: 106246577894593683 / 39085931702241241
 39: 2816596318483412024 / 1036167879649219395
 40: 2922842896378005707 / 1075253811351460636
 41: 5739439214861417731 / 2111421691000680031
 42: 163627140912497702175 / 60195061159370501504
 43: 169366580127359119906 / 62306482850371181535
 44: 332993721039856822081 / 122501544009741683039
 45: 10159178211323063782336 / 3737352803142621672705
 46: 10492171932362920604417 / 3859854347152363355744
 47: 20651350143685984386753 / 7597207150294985028449
 48: 671335376530314420980513 / 246970483156591884266112
 49: 691986726674000405367266 / 254567690306886869294561
 50: 1363322103204314826347779 / 501538173463478753560673
 51: 47044938235620704501191752 / 17306865588065164490357443
 52: 48408260338825019327539531 / 17808403761528643243918116
 53: 95453198574445723828731283 / 35115269349593807734275559
 54: 3484723409018871077161865719 / 1281958100346905721677838240
 55: 3580176607593316800990597002 / 1317073369696499529412113799
 56: 7064900016612187878152462721 / 2599031470043405251089952039
 57: 272046377238856456170784180400 / 100080269231345899070830291281
 58: 279111277255468644048936643121 / 102679300701389304321920243320
 59: 551157654494325100219720823521 / 202759569932735203392750534601
 60: 22325417457028472652837769583961 / 8213062098010797440031941627360
 61: 22876575111522797753057490407482 / 8415821667943532643424692161961
 62: 45201992568551270405895259991443 / 16628883765954330083456633789321
 63: 1921360262990676154800658410048088 / 706828939838025396148603311313443
 64: 1966562255559227425206553670039531 / 723457823603979726232059945102764
 65: 3887922518549903580007212080087619 / 1430286763442005122380663256416207
 66: 173035153071754984945523885193894767 / 63656075415052205110981243227415872
 67: 176923075590304888525531097273982386 / 65086362178494210233361906483832079
 68: 349958228662059873471054982467877153 / 128742437593546415344343149711247951
 69: 16275001594045059068194060290796331424 / 5987238491481629316073146793201237825
 70: 16624959822707118941665115273264208577 / 6115980929075175731417489942912485776
 71: 32899961416752178009859175564060540001 / 12103219420556805047490636736113723601
 72: 1595823107826811663414905542348170128625 / 587070513115801818010968053276371218624
 73: 1628723069243563841424764717912230668626 / 599173732536358623058458690012484942225
 74: 3224546177070375504839670260260400797251 / 1186244245652160441069426743288856160849
 75: 162856031922762339083408277730932270531176 / 59911386015144380676529795854455292984675
 76: 166080578099832714588247947991192671328427 / 61097630260796541117599222597744149145524
 77: 328936610022595053671656225722124941859603 / 121009016275940921794129018452199442130199
 78: 17270784299274775505514371685541689648027783 / 6353566476609724474412308182112115139915872
 79: 17599720909297370559186027911263814589887386 / 6474575492885665396206437200564314582046071
 80: 34870505208572146064700399596805504237915169 / 12828141969495389870618745382676429721961943
 81: 1900607002172193258053007606138761043437306512 / 699194241845636718409618687865091519567990993
 82: 1935477507380765404117708005735566547675221681 / 712022383815132108280237433247767949289952936
 83: 3836084509552958662170715611874327591112528193 / 1411216625660768826689856121112859468857943929
 84: 216756210042346450485677782270697911649976800489 / 79740153420818186402912180215567898205334812960
 85: 220592294551899409147848497882572239241089328682 / 81151370046478955229602036336680757674192756889
 86: 437348504594245859633526280153270150891066129171 / 160891523467297141632514216552248655879527569849
 87: 25586805561018159267892372746772240990922924820600 / 9412859731149713169915426596367102798686791808131
 88: 26024154065612405127525899026925511141813990949771 / 9573751254617010311547940812919351454566319377980
 89: 51610959626630564395418271773697752132736915770371 / 18986610985766723481463367409286454253253111186111
 90: 3122681731663446268852622205448790639106028937172031 / 1148770410400620419199349985370106606649752990544640
 91: 3174292691290076833248040477222488391238765852942402 / 1167757021386387142680813352779393060903006101730751
 92: 6296974422953523102100662682671279030344794790114433 / 2316527431787007561880163338149499667552759092275391
 93: 393586706914408509163489126802841788272616042840037248 / 144792457792180855979250940318048372449174069822804993
 94: 399883681337362032265589789485513067302960837630151681 / 147108985223967863541131103656197872116726828915080384
 95: 793470388251770541429078916288354855575576880470188929 / 291901443016148719520382043974246244565900898737885377
 96: 51181988529450676683726640431940223824139881187722243137 / 18828801338257485912845581918007957524334384348139744512
 97: 51975458917702447225155719348228578679715458068192432066 / 19120702781273634632365963961982203768900285246877629889
 98: 103157447447153123908882359780168802503855339255914675203 / 37949504119531120545211545879990161293234669595017374401
 99: 6860366990429808625211391464839369543934167848958560995464 / 2523787974670327590616327992041332849122388478518024340355
100: 6963524437876961749120273824619538346438023188214475670667 / 2561737478789858711161539537921323010415623148113041714756
End of Main (00:00:00.4602841) 10/31/2008 10:27:15 AM

*/